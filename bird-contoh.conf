root@P0-ROBORDER-BIP:/usr/local/etc # cat bird.conf
define ASN = 142385;

router id 103.172.43.5;

define LOCALv4 = [
        103.172.43.0/24
];

protocol static static4 {
  ipv4;
  route 103.172.43.0/24 reject;

}

define LOCALv6 = [
  2001:df2:ad40::/48
];

define REJECTDEFAULTv4 = [
  0.0.0.0/0
];

define REJECTDEFAULTv6 = [
  ::/0
];

protocol static static6 {
  ipv6;
  route 2001:df2:ad40::/48 reject;
}


# ---- Parameters ----

timeformat base iso long;
timeformat log iso long;
timeformat protocol iso long;
timeformat route iso long;

log syslog all;

protocol device {};

protocol direct { ipv4; ipv6; }

protocol kernel {
  scan time 30;
  learn;

  ipv4 {
    export filter {

      if source = RTS_DEVICE then reject;

      if source = RTS_STATIC && proto != "static4" then {
        accept;
      } else if source = RTS_BGP then {
        krt_prefsrc = 103.172.43.5;
        accept;
      }
      reject;



    };
  };
  merge paths;
}

protocol kernel {
  scan time 30;
  learn;

  ipv6 {
    export filter {

      if source = RTS_DEVICE then reject;


      accept;



    };
  };
  merge paths;
}
# --- Blackholing RTBH---

protocol static null4 {
  ipv4;
  route 192.0.2.1/32 blackhole;
}

protocol static null6 {
  ipv6;
  route 100::1/128 blackhole;
}

function set_blackhole() {
  if (net.type = NET_IP4) then {
    bgp_next_hop = 192.0.2.1;
    print "Added null route for ", net;
  }
  if (net.type = NET_IP6) then {
    bgp_next_hop = 100::1;
    print "Added null route for ", net;
  }
}

function process_blackholes() {
  if (((ASN,1,666) ~ bgp_large_community) && ((net.type = NET_IP4 && net.len = 32) || (net.type = NET_IP6 && net.len = 128))) then {
    set_blackhole();
  }
}

# ---- RPKI ----


roa4 table rpki4;
roa6 table rpki6;

protocol rpki {
  roa4 { table rpki4; };
  roa6 { table rpki6; };

  transport tcp;
  remote "172.65.0.2" port 8282;

  retry keep 90;
  refresh keep 900;
  expire keep 172800;
}

# Rule
function honor_graceful_shutdown() {
  if (65535, 0) ~ bgp_community then bgp_local_pref = 0;
}

function reject_local() {
  if (net ~ LOCALv4) then {
        reject;
  }
  if (net ~ LOCALv6) then {
        reject;
  }
}

function accept_local() {
  if (net ~ LOCALv4) then {
    accept;
  }

  if (net ~ LOCALv6) then {
    accept;
  }
}

function reject_default() {
  if (net ~ REJECTDEFAULTv4) then {
        reject;
  }

  if (net ~ REJECTDEFAULTv6) then {
        reject;
  }
}

# Static routes (Again, there can be multiple instances, for different address
# families and to disable/enable various groups of static routes on the fly).
protocol static {
        ipv4;                   # Again, IPv4 channel with default options

        route 103.172.43.0/24 blackhole;
        route 0.0.0.0/0 blackhole;
#       route 103.116.83.0/24 via 123.108.10.188; #redboox via apjii 

#        route 182.50.255.44/30 via 182.50.255.38;
#        route 182.50.255.48/30 via 182.50.255.38;

#       route 0.0.0.0/0 via 198.51.100.10;
#       route 192.0.2.0/24 blackhole;
#       route 10.0.0.0/8 unreachable;
#       route 10.2.0.0/24 via "eth0";
#       # Static routes can be defined with optional attributes
#       route 10.1.1.0/24 via 198.51.100.3 { rip_metric = 3; };
#       route 10.1.2.0/24 via 198.51.100.3 { ospf_metric1 = 100; };
#       route 10.1.3.0/24 via 198.51.100.4 { ospf_metric2 = 100; };
}

protocol static {
        ipv6;

        route 2001:df2:ad40::/48 blackhole;
        route ::/0 blackhole;
}

# Pipe protocol connects two routing tables. Beware of loops.
# protocol pipe {
#       table master4;          # No ipv4/ipv6 channel definition like in other protocols
#       peer table mrib4;
#       import all;             # Direction peer table -> table
#       export all;             # Direction table -> peer table
# }
define BOGON_ASNS = [
  0,                      # RFC 7607
  23456,                  # RFC 4893 AS_TRANS
  64496..64511,           # RFC 5398 and documentation/example ASNs
  64512..65534,           # RFC 6996 Private ASNs
  65535,                  # RFC 7300 Last 16 bit ASN
  65536..65551,           # RFC 5398 and documentation/example ASNs
  65552..131071,          # RFC IANA reserved ASNs
  4200000000..4294967294, # RFC 6996 Private ASNs
  4294967295 ];           # RFC 7300 Last 32 bit ASN

function reject_bogon_asns()
int set bogon_asns;
{
  bogon_asns = BOGON_ASNS;

  if ( bgp_path ~ bogon_asns ) then {
    print "Reject: bogon AS_PATH: ", net, " ", bgp_path;
    reject;
  }
}

filter default_ok {
        if net = 0.0.0.0/0 then {
        accept;
        } else reject;
}

filter default_ok_v6 {
        if net = ::/0 then {
        accept;
        } else reject;
}

#function rejectas()
#int set asnums;
#        {
#        asnums = [ 131757, 64314, 138849, 139435, 139440, 55691, 24537 ];
#        if bgp_path.last ~ asnums then return false;
#        return true;
#}

function prefixipbipv6()
prefix set ipbipv6;
{
        ipbipv6 = [ 2001:df2:ad40::/48 ];
        if net ~ ipbipv6 then return false;
        return true;
}

function prefixipbip()
prefix set ipbip;
{
        ipbip = [ 103.172.43.0/24 ];
        if net ~ ipbip then return false;

        return true;
}

#MRP
#filter bgp_out_mrp
#{
#        if ! (prefixipbip()) then accept;
#        
#        reject;
#}

filter bgp_out_mrp {
    if ! (prefixipbip()) then {
        bgp_path.prepend(ASN, ASN, ASN);
        accept;
    }

    reject;
}
filter bgp_in_mrp
{
        reject_bogon_asns();
        reject_local();
#        if ! (prefixipbip()) then reject;

        accept;
}

filter bgp_in_mrp_v6
{
        reject_bogon_asns();
        reject_local();
#        if ! (prefixipbipv6()) then accept;

        accept;
}

filter bgp_out_mrp_v6
{
        if ! (prefixipbipv6()) then accept;

        reject;
}


#OPENIXP
filter bgp_out_openixp
{
        if ! (prefixipbip()) then accept;
        
        reject;
}

filter bgp_in_openixp
{
        reject_bogon_asns();
        reject_local();
#        if ! (prefixipbip()) then reject;

        accept;
}

#APJII-IIX
filter bgp_out_apjii
{
        if ! (prefixipbip()) then accept;
        
        reject;
}

filter bgp_in_apjii
{
        reject_bogon_asns();
        reject_local();
#        if ! (prefixipbip()) then reject;

        accept;
}

filter bgp_in_apjii_v6
{
        reject_bogon_asns();
        reject_local();

        accept;
}

filter bgp_out_apjii_v6
{
        if ! (prefixipbipv6()) then accept;

        reject;
}

#APJII-IIX-META
filter bgp_out_apjii_meta
{
        if ! (prefixipbip()) then accept;

        reject;
}

filter bgp_in_apjii_meta
{
        reject_bogon_asns();
        reject_local();
#        if ! (prefixipbip()) then reject;

        accept;
}

filter bgp_in_apjii_v6_meta
{
        reject_bogon_asns();
        reject_local();

        accept;
}

filter bgp_out_apjii_v6_meta
{
        if ! (prefixipbipv6()) then accept;

        reject;
}
 
#BIX
filter bgp_out_bix
{
        if ! (prefixipbip()) then accept;
        
        reject;
}

filter bgp_in_bix
{
        reject_bogon_asns();
        reject_local();
#        if ! (prefixipbip()) then reject;

        accept;
} 

#BIX_META
filter bgp_out_bix_meta
{
        if ! (prefixipbip()) then accept;

        reject;
}

filter bgp_in_bix_meta
{
        reject_bogon_asns();
        reject_local();
#        if ! (prefixipbip()) then reject;

        accept;
}

#JKTIX
filter bgp_out_jktix
{
        if ! (prefixipbip()) then accept;

        reject;
}

filter bgp_in_jktix
{
        reject_bogon_asns();
        reject_local();
#        if ! (prefixipbip()) then reject;

        accept;
} 

#JKTIX_META
filter bgp_out_jktix_meta
{
        if ! (prefixipbip()) then accept;

        reject;
}

filter bgp_in_jktix_meta
{
        reject_bogon_asns();
        reject_local();
#        if ! (prefixipbip()) then reject;

        accept;
}

#JIN
filter bgp_out_jin
{
        if ! (prefixipbip()) then accept;
        
        reject;
}

filter bgp_in_jin
{
        reject_bogon_asns();
        reject_local();
#        if ! (prefixipbip()) then reject;

        accept;
} 

#STARTEL_PEER
filter bgp_out_startel_peer
{
        if ! (prefixipbip()) then accept;

        reject;
}

filter bgp_in_startel_peer
{
        reject_bogon_asns();
        reject_local();
#        if ! (prefixipbip()) then reject;

        accept;
}

#AIX
filter bgp_out_aix
{
        if ! (prefixipbip()) then accept;

        reject;
}

filter bgp_in_aix
{
        reject_bogon_asns();
        reject_local();
#        if ! (prefixipbip()) then reject;

        accept;
}

filter bgp_in_aix_v6
{
        reject_bogon_asns();
        reject_local();
#        if ! (prefixipbipv6()) then accept;

        accept;
}

filter bgp_out_aix_v6
{
        if ! (prefixipbipv6()) then accept;

        reject;
}

#AIX META

filter bgp_out_aix_meta
{
        if ! (prefixipbip()) then accept;

        reject;
}

filter bgp_in_aix_meta
{
        reject_bogon_asns();
        reject_local();
#        if ! (prefixipbip()) then reject;

        accept;
}

filter bgp_in_aix_v6_meta
{
        reject_bogon_asns();
        reject_local();
#        if ! (prefixipbipv6()) then accept;

        accept;
}

filter bgp_out_aix_v6_meta
{
        if ! (prefixipbipv6()) then accept;

        reject;
}

#STARTEL
filter from_startel
{
        reject_bogon_asns();
        if net ~ 103.137.8.0/24 then accept;
        if net ~ 103.137.9.0/24 then accept;
        if net ~ 103.137.8.0/23 then accept;
        else reject;
}

filter bgp_out_startel
{
        if ! (prefixipbip()) then accept;
        
        reject;
}


#####DE-CIX

filter bgp_out_decix
{
        if ! (prefixipbip()) then accept;

        reject;
}


filter bgp_in_decix
{
        reject_bogon_asns();
        reject_local();

        accept;
}

filter bgp_in_decix_v6
{
        reject_bogon_asns();
        reject_local();

        accept;
}

filter bgp_out_decix_v6
{
        if ! (prefixipbipv6()) then accept;

        reject;
}

####DE-CIX-META

filter bgp_out_decix_meta
{
        if ! (prefixipbip()) then accept;
        reject;
}

filter bgp_in_decix_meta
{
        reject_bogon_asns();
        reject_local();
        accept;
}

filter  bgp_in_decix_meta_v6
{
        reject_bogon_asns();
        reject_local();
        accept;
}

filter bgp_out_decix_meta_v6
{
        if ! (prefixipbipv6()) then accept;
        reject;
}

####EDGE-NXT 

filter bgp_out_edgenxt
{
        if ! (prefixipbip()) then accept;
        reject;
}

filter bgp_in_edgenxt
{
        reject_bogon_asns();
        reject_local();
        reject_default();
        accept;
}

filter  bgp_in_edgenxt_v6
{
        reject_bogon_asns();
        reject_local();
        accept;
}

filter bgp_out_edgenxt_v6
{
        if ! (prefixipbipv6()) then accept;
        reject;
}

#RTBH-KOMINFO
filter bgp_out_rtbh
{
        if ! (prefixipbip()) then accept;
        
        reject;
}
filter bgp_in_rtbh
{
        reject_local();
        reject_bogon_asns();
        process_blackholes();
        honor_graceful_shutdown();
        bgp_large_community.add((142385,1,666));
        set_blackhole();
        
        accept;
}

#BGP PEER
protocol bgp IPT_MRP_AS58552 {
        description "IPT_MRP_AS58552";
        local 202.72.198.126 as 142385;
        neighbor 202.72.198.125 as 58552;
        allow local as 0;
        ipv4 {
                import filter bgp_in_mrp;
                export filter bgp_out_mrp;
        };
}

protocol bgp IPTv6_MRP {
        local 2404:fd00:16::15 as 142385;
        neighbor 2404:fd00:16::14 as 58552;
        allow local as 0;
        ipv6 {
                import filter bgp_in_mrp_v6;
                export filter bgp_out_mrp_v6;
        };
}

protocol bgp OPENIXP_AS7717 {
        description "OPENIXP_AS7717";
        local 43.252.146.102 as 142385;
        neighbor 43.252.146.1 as 7717;
        allow local as 0;
        default bgp_local_pref 400;
        ipv4 {
                import filter bgp_in_openixp;
                export filter bgp_out_openixp;
        };
}

##APJII

protocol bgp RS1_APJII_AS7597 {
        description "RS1_APJII_AS7597";
        local 123.108.10.185 as 142385;
        neighbor 123.108.8.111 as 7597;
        allow local as 0;
        default bgp_local_pref 400;
        ipv4 {
                import filter bgp_in_apjii;
                export filter bgp_out_apjii;
        };
}

protocol bgp RS2_APJII {
        description "RS2_APJII_AS7597";
        local 123.108.10.185 as 142385;
        neighbor 123.108.9.111 as 7597;
        allow local as 0;
        default bgp_local_pref 400;
        ipv4 {
                import filter bgp_in_apjii;
                export filter bgp_out_apjii;
        };
}

protocol bgp RS1v6_APJII {
        description "RS1v6_APJII_AS7597";
        local 2001:7fa:2:5::2c9 as 142385;
        neighbor 2001:7fa:2:5:7597::111 as 7597;
        allow local as 0;
        ipv6 {
                import filter bgp_in_apjii_v6;
                export filter bgp_out_apjii_v6;
        };
}

protocol bgp RS2v6_APJII {
        description "RS2v6_APJII_AS7597";
        local 2001:7fa:2:5::2c9 as 142385;
        neighbor 2001:7fa:2:5:7597:2::111 as 7597;
        allow local as 0;
        ipv6 {
                import filter bgp_in_apjii_v6;
                export filter bgp_out_apjii_v6;
        };
}

protocol bgp RS1_APJII_META {
        description "RS1_APJII_META_AS32934";
        local 123.108.10.185 as 142385;
        neighbor 123.108.9.129 as 32934;
        allow local as 0;
        default bgp_local_pref 1500;
        ipv4 {
                import filter bgp_in_apjii_meta;
                export filter bgp_out_apjii_meta;
        };
}

protocol bgp RS2_APJII_META {
        description "RS2_APJII_META_AS32934";
        local 123.108.10.185 as 142385;
        neighbor 123.108.9.130 as 32934;
        allow local as 0;
#        default bgp_local_pref 1500;
        ipv4 {
                import filter bgp_in_apjii_meta;
                export filter bgp_out_apjii_meta;
        };
}

protocol bgp RS3_APJII_META {
        description "RS3_APJII_META_AS32934";
        local 123.108.10.185 as 142385;
        neighbor 123.108.10.170 as 32934;
        allow local as 0;
#        default bgp_local_pref 1500;
        ipv4 {
                import filter bgp_in_apjii_meta;
                export filter bgp_out_apjii_meta;
        };
}

protocol bgp RS4_APJII_META {
        description "RS4_APJII_META_AS32934";
        local 123.108.10.185 as 142385;
        neighbor 123.108.10.171 as 32934;
        allow local as 0;
#        default bgp_local_pref 1500;
        ipv4 {
                import filter bgp_in_apjii_meta;
                export filter bgp_out_apjii_meta;
        };
}

protocol bgp RS1v6_APJII_META {
        description "RS1v6_APJII_META_AS32934";
        local 2001:7fa:2:5::2c9 as 142385;
        neighbor 2001:7fa:2:5::181 as 32934;
        allow local as 0;
        ipv6 {
                import filter bgp_in_apjii_v6_meta;
                export filter bgp_out_apjii_v6_meta;
        };
}

protocol bgp RS2v6_APJII_META {
        description "RS2v6_APJII_META_AS32934";
        local 2001:7fa:2:5::2c9 as 142385;
        neighbor 2001:7fa:2:5::182 as 32934;
        allow local as 0;
        ipv6 {
                import filter bgp_in_apjii_v6_meta;
                export filter bgp_out_apjii_v6_meta;
        };
}

#protocol bgp RS3v6_APJII_META {
#        description "RS3v6_APJII_META_AS32934";
#        local 2001:7fa:2:5::2c9 as 142385;
#        neighbor 2001:7fa:2:5::2ba as 32934;
#        allow local as 0;
#        ipv6 {
#                import filter bgp_in_apjii_v6_meta;
#                export filter bgp_out_apjii_v6_meta;
#        };
#}

#protocol bgp RS4v6_APJII_META {
#        description "RS4v6_APJII_META_AS32934";
#        local 2001:7fa:2:5::2c9 as 142385;
#        neighbor 2001:7fa:2:5::2bb as 32934;
#        allow local as 0;
#        ipv6 {
#                import filter bgp_in_apjii_v6_meta;
#                export filter bgp_out_apjii_v6_meta;
#        };
#}


###BIX
protocol bgp RS1_BIX {
        description "RS1_BIZNETIX_AS38060";
        local 218.100.41.203 as 142385;
        neighbor 218.100.41.100 as 38060;
        allow local as 0;
        default bgp_local_pref 600;
        ipv4 {
                import filter bgp_in_bix;
                export filter bgp_out_bix;
        };
}

protocol bgp RS2_BIX {
        description "RS2_BIZNETIX_AS38060";
        local 218.100.41.203 as 142385;
        neighbor 218.100.41.101 as 38060;
        allow local as 0;
#        default bgp_local_pref 600;
        ipv4 {
                import filter bgp_in_bix;
                export filter bgp_out_bix;
        };
}

###BIX_META
#protocol bgp RS1_BIX_META {
#        description "RS1_BIZNETIX_META_AS32934";
#        local 218.100.41.102 as 142385;
#        neighbor 218.100.41.98 as 32934;
#        allow local as 0;
#        default bgp_local_pref 600;
#        ipv4 {
#                import filter bgp_in_bix;
#                export filter bgp_out_bix;
#        };
#}

#protocol bgp RS2_BIX_META {
#        description "RS2_BIZNETIX_META_AS32934";
#        local 218.100.41.102 as 142385;
#        neighbor 218.100.41.99 as 32934;
#        allow local as 0;
#        default bgp_local_pref 600;
#        ipv4 {
#                import filter bgp_in_bix;
#                export filter bgp_out_bix;
#        };
#}

###JKTIX
protocol bgp RS1v4_JKTIX {
        description "RS1_JKTIX_AS137295";
        local 119.11.185.229 as 142385;
        neighbor 119.11.184.101 as 137295;
        allow local as 0;
#       default bgp_local_pref 500;
        ipv4 {
                import filter bgp_in_jktix;
                export filter bgp_out_jktix;
        };
}

protocol bgp RS2v4_JKTIX {
        description "RS2_JKTIX_AS137295";
        local 119.11.185.229 as 142385;
        neighbor 119.11.184.102 as 137295;
        allow local as 0;
        ipv4 {
                import filter bgp_in_jktix;
                export filter bgp_out_jktix;
        };
}

protocol bgp RS3v4_JKTIX {
        description "RS3_JKTIX_AS137295";
        local 119.11.185.229 as 142385;
        neighbor 119.11.185.222 as 137295;
        allow local as 0;
        ipv4 {
                import filter bgp_in_jktix;
                export filter bgp_out_jktix;
        };
}
###JKTIX_META
protocol bgp RS1v4_JKTIX_META {
        description "RS1_JKTIX_META_AS32934";
        local 119.11.185.229 as 142385;
        neighbor 119.11.184.23 as 32934;
        allow local as 0;
#       default bgp_local_pref 500;
        ipv4 {
                import filter bgp_in_jktix_meta;
                export filter bgp_out_jktix_meta;
        };
}

protocol bgp RS2v4_JKTIX_META {
        description "RS2_JKTIX_META_AS32934";
        local 119.11.185.229 as 142385;
        neighbor 119.11.184.24 as 32934;
        allow local as 0;
        ipv4 {
                import filter bgp_in_jktix_meta;
                export filter bgp_out_jktix_meta;
        };
}

##JIN
protocol bgp JIN {
        description "JIN_AS141613";
        local 10.11.245.6 as 142385;
        neighbor 10.11.245.5 as 141613;
        allow local as 0;
#        default bgp_local_pref 500;
        ipv4 {
                import filter bgp_in_jin;
                export filter bgp_out_jin;
        };
}

##STARTEL
protocol bgp STARTEL_PEER {
        description "STARTEL_PEER_AS138824";
        local 10.9.64.50 as 142385;
        neighbor 10.9.64.49 as 138824;
        allow local as 0;
        default bgp_local_pref 1500;
        ipv4 {
                import filter from_startel;
                export filter bgp_out_startel;
        };
}

##AIX 
protocol bgp RS1v4_AIX {
        description "RS1v4_AIX_AS152007";
        local 43.254.82.42 as 142385;
        neighbor 43.254.82.31 as 152007;
        allow local as 0;
#        default bgp_local_pref 500;
        ipv4 {
                import filter bgp_in_aix;
                export filter bgp_out_aix;
        };
}

protocol bgp RS2v4_AIX {
        description "RS2v4_AIX_AS152007";
        local 43.254.82.42 as 142385;
        neighbor 43.254.82.51 as 152007;
        allow local as 0;
#        default bgp_local_pref 500;
        ipv4 {
                import filter bgp_in_aix;
                export filter bgp_out_aix;
        };
}

protocol bgp RS1v4_AIX_META {
        description "RS1v4_AIX_META_AS32934";
        local 43.254.82.42 as 142385;
        neighbor 43.254.82.4 as 32934;
        allow local as 0;
        default bgp_local_pref 1500;
        ipv4 {
                import filter bgp_in_aix_meta;
                export filter bgp_out_aix_meta;
        };
}

protocol bgp RS2v4_AIX_META {
        description "RS2v4_AIX_META_AS32934";
        local 43.254.82.42 as 142385;
        neighbor 43.254.82.5 as 32934;
        allow local as 0;
#        default bgp_local_pref 1500;
        ipv4 {
                import filter bgp_in_aix_meta;
                export filter bgp_out_aix_meta;
        };
}

protocol bgp RS1v6_AIX {
        local 2401:91e0:31::142:385:1 as 142385;
        neighbor 2401:91e0:31::152:7:31 as 152007;
        allow local as 0;
        ipv6 {
                import filter bgp_in_aix_v6;
                export filter bgp_out_aix_v6;
        };
}

protocol bgp RS2v6_AIX {
        local 2401:91e0:31::142:385:1 as 142385;
        neighbor 2401:91e0:31::152:7:51 as 152007;
        allow local as 0;
        ipv6 {
                import filter bgp_in_aix_v6;
                export filter bgp_out_aix_v6;
        };
}

protocol bgp RS1v6_AIX_META {
        local 2401:91e0:31::142:385:1 as 142385;
        neighbor 2401:91e0:31::32:934:1 as 32934;
        allow local as 0;
        ipv6 {
                import filter bgp_in_aix_v6_meta;
                export filter bgp_out_aix_v6_meta;
        };
}

protocol bgp RS2v6_AIX_META {
        local 2401:91e0:31::142:385:1 as 142385;
        neighbor 2401:91e0:31::32:934:2 as 32934;
        allow local as 0;
        ipv6 {
                import filter bgp_in_aix_v6_meta;
                export filter bgp_out_aix_v6_meta;
        };
}

#protocol bgp STARTEL {
#        description "STARTEL_via_AIX_AS138824";
#        local 43.254.82.42 as 142385;
#        neighbor 43.254.82.41 as 138824;
#        allow local as 0;
#        default bgp_local_pref 1500;
#        ipv4 {
#                import filter from_startel;
#                export filter bgp_out_startel;
#        };
#}

##### DEC-IX JAKARTA AS9748

protocol bgp RS1v4_DECIX_JKT {
        description "RS1v4_DECIX_JKT_AS9748";
        local 103.159.71.49 as 142385;
        neighbor 103.159.71.124 as 9748;
        allow local as 0;
#        default bgp_local_pref 500;
        ipv4 {
                import filter bgp_in_decix;
                export filter bgp_out_decix;
        };
}

protocol bgp RS2v4_DECIX_JKT {
        description "RS2v4_DECIX_JKT_AS9748";
        local 103.159.71.49 as 142385;
        neighbor 103.159.71.125 as 9748;
        allow local as 0;
#        default bgp_local_pref 500;
        ipv4 {
                import filter bgp_in_decix;
                export filter bgp_out_decix;
        };
}

protocol bgp RS1v6_DECIX_JKT {
        description "RS1v6_DECIX_JKT_AS9748";
        local 2001:df5:7880:0:2:2c31:0:1 as 142385;
        neighbor 2001:df5:7880::2614:a:1 as 9748;
        allow local as 0;
        ipv6 {
                import filter bgp_in_aix_v6;
                export filter bgp_out_aix_v6;
        };
}

protocol bgp RS2v6_DECIX_JKT {
        description "RS2v6_DECIX_JKT_AS9748";
        local 2001:df5:7880:0:2:2c31:0:1 as 142385;
        neighbor 2001:df5:7880::2614:a:2 as 9748;
        allow local as 0;
        ipv6 {
                import filter bgp_in_aix_v6;
                export filter bgp_out_aix_v6;
        };
}

##### DEC-IX-META JAKARTA AS32934

protocol bgp RS1v4_DECIX_META {
        description "RS1v4_DECIX_JKT_AS32934";
        local 103.159.71.49 as 142385;
        neighbor 103.159.71.14 as 32934;
        allow local as 0;
#        default bgp_local_pref 1500;
        ipv4 {
                import filter bgp_in_decix_meta;
                export filter bgp_out_decix_meta;
        };
}

protocol bgp RS2v4_DECIX_META {
        description "RS2v4_DECIX_JKT_AS9748";
        local 103.159.71.49 as 142385;
        neighbor 103.159.71.15 as 32934;
        allow local as 0;
        default bgp_local_pref 1500;
        ipv4 {
                import filter bgp_in_decix_meta;
                export filter bgp_out_decix_meta;
        };
}

protocol bgp RS1v6_DECIX_META {
        description "RS1v6_DECIX_META_AS32934";
        local 2001:df5:7880:0:2:2c31:0:1 as 142385;
        neighbor 2001:df5:7880::80a6:0:1 as 32934;
        allow local as 0;
        ipv6 {
                import filter bgp_in_decix_meta_v6;
                export filter bgp_out_decix_meta_v6;
        };
}

protocol bgp RS2v6_DECIX_META {
        description "RS2v6_DECIX_META_AS32934";
        local 2001:df5:7880:0:2:2c31:0:1 as 142385;
        neighbor 2001:df5:7880::80a6:0:2 as 32934;
        allow local as 0;
        ipv6 {
                import filter bgp_in_decix_meta_v6;
                export filter bgp_out_decix_meta_v6;
        };
}

#####DE-CIX ASEAN AS38137

protocol bgp RS1v4_DECIX_ASEAN {
        description "RS1v4_DECIX_ASEAN_AS38137";
        local 103.162.254.125 as 142385;
        neighbor 103.162.254.252 as 38137;
        allow local as 0;
#        default bgp_local_pref 500;
        ipv4 {
                import filter bgp_in_decix;
                export filter bgp_out_decix;
        };
}

protocol bgp RS2v4_DECIX_ASEAN {
        description "RS2v4_DECIX_ASEAN_AS38137";
        local 103.162.254.125 as 142385;
        neighbor 103.162.254.253 as 38137;
        allow local as 0;
#        default bgp_local_pref 500;
        ipv4 {
                import filter bgp_in_decix;
                export filter bgp_out_decix;
        };
}

protocol bgp RS1v6_DECIX_ASEAN {
        description "RS1v6_DECIX_ASEAN_AS38137";
        local 2001:df6:480:0:2:2c31:0:1 as 142385;
        neighbor 2001:df6:480::94f9:a:1 as 38137;
        allow local as 0;
        ipv6 {
                import filter bgp_in_aix_v6;
                export filter bgp_out_aix_v6;
        };
}

protocol bgp RS2v6_DECIX_ASEAN {
        description "RS2v6_DECIX_ASEAN_AS38137";
        local 2001:df6:480:0:2:2c31:0:1 as 142385;
        neighbor 2001:df6:480::94f9:a:2 as 38137;
        allow local as 0;
        ipv6 {
                import filter bgp_in_aix_v6;
                export filter bgp_out_aix_v6;
        };
}

##### EDGE-NXT AS150528

protocol bgp RS1v4_EDGENXT {
        description "RS1v4_EDGENXT_AS150528";
        local 103.61.232.122 as 142385;
        neighbor 103.61.232.1 as 150528;
        allow local as 0;
#        default bgp_local_pref 500;
        ipv4 {
                import filter bgp_in_edgenxt;
                export filter bgp_out_edgenxt;
        };
}

protocol bgp RS2v4_EDGENXT {
        description "RS2v4_EDGENXT_AS150528";
        local 103.61.232.122 as 142385;
        neighbor 103.61.232.2 as 150528;
        allow local as 0;
#        default bgp_local_pref 500;
        ipv4 {
                import filter bgp_in_edgenxt;
                export filter bgp_out_edgenxt;
        };
}

#protocol bgp RS1v6_EDGENXT {
#       description "RS1v6_EDGEXNT_AS150528";
#        local 2001:df1:d440:1::122 as 142385;
#        neighbor 2001:df1:d440:1::1 as 150528;
#        allow local as 0;
#        ipv6 {
#                import filter bgp_in_edgenxt_v6;
#                export filter bgp_out_edgenxt_v6;
#        };
#}

#protocol bgp RS2v6_EDGENXT {
#       description "RS2v6_EDGENXT_AS150528";
#        local 2001:df1:d440:1::122 as 142385;
#        neighbor 2001:df1:d440:1::2 as 150528;
#        allow local as 0;
#        ipv6 {
#                import filter bgp_in_edgenxt_v6;
#                export filter bgp_out_edgenxt_v6;
#        };
#}

##### EDGE-NXT-META AS32934

protocol bgp RS1v4_EDGE_META_AS32934 {
        description "EDGENXT_METAAS32934";
        local 103.61.232.122 as 142385;
        neighbor 103.61.232.100 as 32934;
        allow local as 0;
#        default bgp_local_pref 500;
        ipv4 {
                import filter bgp_in_edgenxt;
                export filter bgp_out_edgenxt;
        };
}

protocol bgp RS2v4_EDGE_META_AS32934 {
        description "EDGENXT_METAAS32934";
        local 103.61.232.122 as 142385;
        neighbor 103.61.232.101 as 32934;
        allow local as 0;
#        default bgp_local_pref 500;
        ipv4 {
                import filter bgp_in_edgenxt;
                export filter bgp_out_edgenxt;
        };
}

###### IBGP BIP ######

protocol bgp BIP_P01 {
        local 103.172.43.13 as 142385;
        neighbor 103.172.43.14 as 142385;
        ipv4 {
                import all;
                export filter default_ok;
#               export all;
                next hop self;
        };
}

protocol bgp BIP_P01_V6 {
        local 2001:df2:ad40::100 as 142385;
        neighbor 2001:df2:ad40::101 as 142385;
        ipv6 {
                import all;
                export filter default_ok_v6;
        };
}

protocol bgp BIP_P02 {
        local 103.172.43.5 as 142385;
        neighbor 103.172.43.6 as 142385;
        ipv4 {
                import all;
                export filter default_ok;
                next hop self;
        };
}

protocol bgp BIP_P02_V6 {
        local 2001:df2:ad40::102 as 142385;
        neighbor 2001:df2:ad40::103 as 142385;
        ipv6 {
                import all;
                export filter default_ok_v6;
        };
}

protocol bgp BIP_P03 {
        local 103.172.43.9 as 142385; 
        neighbor 103.172.43.10 as 142385;
        ipv4 {
                import all;
                export filter default_ok;
                next hop self;
        };
}

#####BGP RTBH#######

protocol bgp RTBH_01 {
        local 103.172.43.5 as 142385; 
        neighbor 103.158.253.146 as 65535;
        multihop 255;
        ipv4 {
                import filter {
                  reject_local(); 
                  bgp_next_hop = 103.158.253.146;
                  bgp_local_pref = 100;
                  process_blackholes();
                  honor_graceful_shutdown();
                  bgp_large_community.add((142385,1,666));
                  set_blackhole();
                  accept;
                };
                export filter bgp_out_rtbh;
        };
}

protocol bgp RTBH_02 {
        local 103.172.43.5 as 142385; 
        neighbor 103.163.102.122 as 65535;
        multihop 255;
        ipv4 {
                import filter {
                  reject_local();
                  bgp_next_hop = 103.163.102.122;
                  bgp_local_pref = 100;
                  process_blackholes();
                  honor_graceful_shutdown();
                  bgp_large_community.add((142385,1,666));
                  set_blackhole();
                  accept;
                };
                export filter bgp_out_rtbh;
        };
}

protocol bgp RTBH_03 {
        local 103.172.43.5 as 142385; 
        neighbor 202.57.26.242 as 65535;
        multihop 255;
        ipv4 {
                import filter {
                  reject_local();
                  bgp_next_hop = 202.57.26.242;
                  bgp_local_pref = 100;
                  process_blackholes();
                  honor_graceful_shutdown();
                  bgp_large_community.add((142385,1,666));
                  set_blackhole();
                  accept;
                };
                export filter bgp_out_rtbh;
        };
}
root@P0-ROBORDER-BIP:/usr/local/etc # 
